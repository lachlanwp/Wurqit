<!DOCTYPE html>
<html>
  <head>
    <title>WURQIT</title>
    <!-- Favicons and App Icons -->
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="media/icon/windows/favicon-32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="57x57"
      href="media/icon/windows/favicon-57.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="72x72"
      href="media/icon/windows/favicon-72.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="media/icon/windows/favicon-96.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="120x120"
      href="media/icon/windows/favicon-120.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="128x128"
      href="media/icon/windows/favicon-128.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="144x144"
      href="media/icon/windows/favicon-144.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="152x152"
      href="media/icon/windows/favicon-152.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="195x195"
      href="media/icon/windows/favicon-195.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="228x228"
      href="media/icon/windows/favicon-228.png"
    />
    <link rel="shortcut icon" href="media/icon/windows/favicon.ico" />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="media/icon/windows/favicon-120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="media/icon/windows/favicon-152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="media/icon/windows/favicon-195.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="228x228"
      href="media/icon/windows/favicon-228.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="media/icon/windows/favicon-32.png"
    />
    <link rel="manifest" href="/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta
      name="msapplication-TileImage"
      content="media/icon/windows/favicon-144.png"
    />
    <meta name="theme-color" content="#ffffff" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:; font-src 'self'; connect-src 'self';"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <div class="app-header">
        <img src="icon.png" alt="WURQIT App Icon" class="app-icon" />
        <h1 class="app-title">WURQIT</h1>
        <h1 id="download-counter">Loading downloads...</h1>
      </div>

      <!-- Workflow Progress Bar -->
      <div class="workflow-progress">
        <div class="workflow-step active" data-step="1">
          <div class="step-number">1</div>
          <div class="step-label">Duration</div>
        </div>
        <div class="workflow-step" data-step="2">
          <div class="step-number">2</div>
          <div class="step-label">Categories</div>
        </div>
        <div class="workflow-step" data-step="3">
          <div class="step-number">3</div>
          <div class="step-label">Equipment</div>
        </div>
        <div class="workflow-step" data-step="4">
          <div class="step-number">4</div>
          <div class="step-label">Body Groups</div>
        </div>
        <div class="workflow-step" data-step="5">
          <div class="step-number">5</div>
          <div class="step-label">Videos</div>
        </div>
        <div class="workflow-step" data-step="6">
          <div class="step-number">6</div>
          <div class="step-label">Summary</div>
        </div>
      </div>

      <form id="workoutForm">
        <!-- Step 1: Duration Settings -->
        <div class="workflow-step-content active" data-step="1">
          <div class="step-header">
            <h2>‚è±Ô∏è Step 1: Duration Settings</h2>
            <p>Configure your workout timing parameters</p>
          </div>

          <div class="form-section">
            <div class="form-group">
              <label for="workDuration">Work Duration:</label>
              <select id="workDuration" required>
                <option value="">Select work duration</option>
              </select>
              <div class="error" id="workDurationError"></div>
            </div>

            <div class="form-group">
              <label for="restDuration">Rest Duration:</label>
              <select id="restDuration" required>
                <option value="">Select rest duration</option>
              </select>
              <div class="error" id="restDurationError"></div>
            </div>

            <div class="form-group">
              <label for="setsPerStation">Number of Sets:</label>
              <select id="setsPerStation" required>
                <option value="">Select number of sets</option>
              </select>
              <div class="error" id="setsPerStationError"></div>
            </div>

            <div class="form-group">
              <label for="stationRest">Station Rest:</label>
              <select id="stationRest" required>
                <option value="">Select station rest</option>
              </select>
              <div class="error" id="stationRestError"></div>
            </div>

            <div class="form-group">
              <label for="totalWorkoutDuration">Total Workout Duration:</label>
              <select id="totalWorkoutDuration" required>
                <option value="">Select total workout duration</option>
              </select>
              <div class="error" id="totalWorkoutDurationError"></div>
            </div>
          </div>

          <div class="workflow-navigation">
            <button type="button" class="next-btn">
              Next: Exercise Categories ‚Üí
            </button>
          </div>
        </div>

        <!-- Step 2: Exercise Categories -->
        <div class="workflow-step-content" data-step="2">
          <div class="step-header">
            <h2>üìÇ Step 2: Exercise Categories</h2>
            <p>Select the types of exercises you want in your workout</p>
          </div>

          <div class="form-section">
            <div id="categoriesContainer">
              <div class="loading">Loading categories...</div>
            </div>
            <div class="error" id="categoriesError"></div>
          </div>

          <div class="workflow-navigation">
            <button type="button" class="back-btn">
              ‚Üê Back: Duration Settings
            </button>
            <button type="button" class="next-btn">Next: Equipment ‚Üí</button>
          </div>
        </div>

        <!-- Step 3: Equipment -->
        <div class="workflow-step-content" data-step="3">
          <div class="step-header">
            <h2>üèãÔ∏è Step 3: Equipment</h2>
            <p>Choose the equipment you have available</p>
          </div>

          <div class="form-section">
            <div id="equipmentContainer">
              <div class="loading">Loading equipment...</div>
            </div>
            <div class="error" id="equipmentError"></div>
          </div>

          <div class="workflow-navigation">
            <button type="button" class="back-btn">
              ‚Üê Back: Exercise Categories
            </button>
            <button type="button" class="next-btn">Next: Body Groups ‚Üí</button>
          </div>
        </div>

        <!-- Step 4: Body Groups -->
        <div class="workflow-step-content" data-step="4">
          <div class="step-header">
            <h2>üßç Step 4: Body Groups</h2>
            <p>Select which body parts to focus on</p>
          </div>

          <div class="form-section">
            <div id="bodyGroupContainer">
              <div class="loading">
                Select equipment first to load body groups
              </div>
            </div>
            <div class="error" id="bodyGroupError"></div>
          </div>

          <div class="workflow-navigation">
            <button type="button" class="back-btn">‚Üê Back: Equipment</button>
            <button type="button" class="next-btn">
              Next: Video Selection ‚Üí
            </button>
          </div>
        </div>

        <!-- Step 5: Video Selection -->
        <div class="workflow-step-content" data-step="5">
          <div class="step-header">
            <h2>üé¨ Step 5: Exercise Video Selection</h2>
            <p>Choose specific exercises for your workout</p>
          </div>

          <div class="form-section">
            <div class="video-selection-header">
              <div class="video-selection-info">
                <span id="videoSelectionCount">0 out of 0 selected</span>
                <span id="videoSelectionLimit" class="video-limit-info"></span>
              </div>
              <div class="video-selection-controls">
                <button type="button" id="selectAllBtn" class="secondary-btn">
                  Select All
                </button>
                <button type="button" id="deselectAllBtn" class="secondary-btn">
                  Deselect All
                </button>
                <button
                  type="button"
                  id="randomSelectBtn"
                  class="secondary-btn"
                >
                  Random Select
                </button>
              </div>
            </div>
            <div id="videoSelectionContainer">
              <div class="loading">Loading available videos...</div>
            </div>
            <div class="error" id="videoSelectionError"></div>
          </div>

          <div class="workflow-navigation">
            <button type="button" class="back-btn">‚Üê Back: Body Groups</button>
            <button type="button" class="next-btn">Next: Summary ‚Üí</button>
          </div>
        </div>

        <!-- Step 6: Final Summary -->
        <div class="workflow-step-content" data-step="6">
          <div class="step-header">
            <h2>üìã Step 6: Final Summary</h2>
            <p>Review your workout configuration and generate the video</p>
          </div>

          <div class="form-section">
            <div class="summary-section">
              <h3>Workout Summary</h3>
              <div id="finalSummary">
                <div class="loading">Loading summary...</div>
              </div>
            </div>

            <div class="form-section">
              <h3>üìÅ Output Folder</h3>
              <div class="form-group">
                <label for="outputFolder">Save video to:</label>
                <div class="folder-input-container">
                  <input
                    type="text"
                    id="outputFolder"
                    class="folder-input"
                    readonly
                    placeholder="Click 'Choose Folder' to select where to save the video"
                  />
                  <button
                    type="button"
                    id="selectFolderBtn"
                    class="submit-btn folder-button"
                  >
                    üìÇ Choose Folder
                  </button>
                </div>
                <div class="error" id="outputFolderError"></div>
                <small class="folder-help-text">
                  Please select a folder to save your workout video
                </small>
              </div>
            </div>
          </div>

          <div class="workflow-navigation">
            <button type="button" class="back-btn">
              ‚Üê Back: Video Selection
            </button>
            <button type="submit" class="submit-btn" id="submitBtn">
              üé¨ Generate
            </button>
          </div>
        </div>
      </form>

      <!-- Progress Container -->
      <div class="progress-container" id="progressContainer">
        <div class="progress-text" id="progressText">0%</div>
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-message" id="progressMessage">Initializing...</div>
      </div>

      <div id="output"></div>
    </div>

    <!-- Update Progress Overlay -->
    <div class="update-overlay" id="updateOverlay">
      <div class="update-modal">
        <div class="update-header">
          <h3>üîÑ Downloading Update</h3>
        </div>
        <div class="update-content">
          <div class="update-progress-text" id="updateProgressText">0%</div>
          <div class="update-progress-bar">
            <div class="update-progress-fill" id="updateProgressFill"></div>
          </div>
          <div class="update-message" id="updateMessage">
            Starting download...
          </div>
        </div>
      </div>
    </div>

    <script src="src/script.js"></script>

    <script type="module">
      import { getTotalDownloadCount } from "./githubDownloads.js";

      async function showDownloads() {
        const total = await getTotalDownloadCount();
        const el = document.getElementById("download-counter");
        if (total > 0) {
          el.textContent = `Join over ${total.toLocaleString()} other users already using Wurqit`;
        } else {
          el.textContent = "Download stats unavailable";
        }
      }

      showDownloads();
    </script>
  </body>
</html>
